<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ¹›æ±Ÿä¸­è€ƒæ€»åˆ†æŠ˜ç®—è®¡ç®—å™¨</title>
    <style>
        html {
            font-size: 16px !important;
            -webkit-text-size-adjust: 100% !important;
            text-size-adjust: 100% !important;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "SimSun", å®‹ä½“, Arial, sans-serif;
        }
        body {
            background: #f5f7fa;
            padding: 0.9375rem;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }
        .calculator-card {
            width: 100%;
            max-width: 37.5rem;
            background: #fff;
            border-radius: 0.75rem;
            box-shadow: 0 0.25rem 0.9375rem rgba(0, 0, 0, 0.08);
            padding: 1.5625rem;
            transition: transform 0.3s ease;
            position: relative;
        }
        .calculator-card:hover {
            transform: translateY(-0.1875rem);
        }
        .history-btn {
            position: absolute;
            top: 1.25rem;
            right: 1.25rem;
            padding: 0.25rem 0.5rem;
            background: #4299e1;
            color: #fff;
            border: none;
            border-radius: 0.375rem;
            font-size: 0.625rem;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        .history-btn:hover {
            background: #3182ce;
        }
        .history-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
            padding: 1.25rem;
        }
        .history-content {
            background: #fff;
            border-radius: 0.625rem;
            width: 100%;
            max-width: 31.25rem;
            max-height: 80vh;
            overflow-y: auto;
            padding: 1.25rem;
            position: relative;
        }
        .close-modal {
            position: absolute;
            top: 0.9375rem;
            right: 0.9375rem;
            background: transparent;
            border: none;
            font-size: 1.25rem;
            cursor: pointer;
            color: #64748b;
        }
        .history-title {
            font-size: 1.125rem;
            color: #2d3748;
            margin-bottom: 0.9375rem;
            text-align: center;
        }
        .history-empty {
            text-align: center;
            color: #64748b;
            padding: 1.875rem 0;
        }
        .history-item {
            border: 0.0625rem solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 0.9375rem;
            margin-bottom: 0.75rem;
        }
        .history-time {
            font-size: 0.8125rem;
            color: #64748b;
            margin-bottom: 0.625rem;
        }
        .history-total {
            font-size: 1rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 0.5rem;
        }
        .history-detail {
            font-size: 0.8125rem;
            color: #4a5568;
            margin-top: 0.5rem;
        }
        .history-detail-item {
            display: flex;
            justify-content: space-between;
            margin-top: 0.25rem;
        }
        .card-title {
            text-align: center;
            color: #2d3748;
            font-size: 1.375rem;
            margin-bottom: 0.625rem;
        }
        .card-subtitle {
            text-align: center;
            color: #64748b;
            font-size: 0.875rem;
            margin-bottom: 1.25rem;
        }
        .form-group {
            margin-bottom: 1.375rem;
            display: flex;
            flex-direction: column;
            gap: 0.625rem;
        }
        .form-label {
            color: #2d3748;
            font-size: 1rem;
            font-weight: 600;
            padding-left: 0.125rem;
        }
        .sub-label {
            color: #64748b;
            font-size: 0.875rem;
            font-weight: normal;
            margin-top: -0.5rem;
            padding-left: 0.125rem;
        }
        .form-input {
            padding: 0.75rem 0.9375rem;
            border: 0.0625rem solid #e2e8f0;
            border-radius: 0.5rem;
            font-size: 0.9375rem;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        .form-input::placeholder {
            color: #94a3b8;
        }
        .form-input:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 0.1875rem rgba(66, 153, 225, 0.1);
        }
        .select-group {
            display: flex;
            gap: 0.9375rem;
            flex-wrap: wrap;
            align-items: center;
            padding: 0.375rem 0;
        }
        .select-item {
            display: flex;
            align-items: center;
            gap: 0.375rem;
            color: #4a5568;
            font-size: 0.875rem;
        }
        .select-item input {
            width: 1rem;
            height: 1rem;
            accent-color: #4299e1;
        }
        .recommend-tag {
            color: #10b981;
            font-weight: 600;
            margin-left: 0.25rem;
            font-size: 0.8125rem;
        }
        .group-divider {
            height: 0.0625rem;
            background: #f0f0f0;
            margin: 0.9375rem 0;
        }
        .calc-btn {
            width: 100%;
            padding: 0.875rem;
            background: #4299e1;
            color: #fff;
            border: none;
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease, opacity 0.3s ease;
            margin: 0.625rem 0 1.5625rem;
        }
        .calc-btn:hover {
            background: #3182ce;
        }
        .calc-btn:active {
            opacity: 0.9;
        }
        .total-result {
            text-align: center;
            padding: 1.125rem;
            background: #f7fafc;
            border-radius: 0.5rem;
            border: 0.0625rem solid #e2e8f0;
            margin-bottom: 1.25rem;
        }
        .result-label {
            color: #4a5568;
            font-size: 0.9375rem;
            margin-bottom: 0.3125rem;
        }
        .result-value {
            color: #2d3748;
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: 0.03125rem;
            margin-bottom: 0.5rem;
        }
        .result-comment {
            color: #10b981;
            font-size: 0.875rem;
            font-weight: 600;
        }
        .detail-group {
            background: #f7fafc;
            border-radius: 0.5rem;
            border: 0.0625rem solid #e2e8f0;
            padding: 0.9375rem;
            margin-bottom: 1.25rem;
        }
        .detail-title {
            color: #2d3748;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.625rem;
            padding-bottom: 0.5rem;
            border-bottom: 0.0625rem solid #e2e8f0;
        }
        .detail-item {
            display: flex;
            justify-content: space-between;
            padding: 0.375rem 0;
            color: #4a5568;
            font-size: 0.875rem;
        }
        .detail-label {
            flex: 1;
        }
        .detail-value {
            flex: 1;
            text-align: right;
        }
        .non-official-tip {
            color: #94a3b8;
            font-size: 0.75rem;
            text-align: right;
            margin-top: 0.5rem;
            font-weight: normal;
        }
        .tip-group {
            background-color: #fef7fb;
            border-left: 0.1875rem solid #f6ad55;
            padding: 0.9375rem;
            border-radius: 0.375rem;
            margin-bottom: 1.25rem;
        }
        .tip-title {
            color: #2d3748;
            font-size: 0.9375rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        .tip-content {
            color: #4a5568;
            font-size: 0.875rem;
            line-height: 1.8;
        }
        /* ä»‹ç»å¼¹çª—æ ·å¼ */
        .popup-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 999;
            padding: 1.25rem;
        }
        .popup-content {
            background: #fff;
            border-radius: 0.75rem;
            width: 100%;
            max-width: 28rem;
            padding: 1.5625rem 1.25rem;
            box-shadow: 0 0.375rem 1.25rem rgba(0, 0, 0, 0.15);
            position: relative;
        }
        .popup-text {
            color: #4a5568;
            font-size: 0.875rem;
            line-height: 1.7;
            margin-bottom: 1.5625rem;
        }
        .popup-text .reward-link {
            color: #4299e1;
            font-weight: 600;
            text-decoration: underline;
            cursor: pointer;
        }
        .popup-checkbox {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #64748b;
            font-size: 0.8125rem;
            margin-bottom: 1.25rem;
        }
        .popup-checkbox input {
            width: 1rem;
            height: 1rem;
            accent-color: #4299e1;
        }
        .popup-confirm-btn {
            width: 100%;
            padding: 0.875rem;
            background: #4299e1;
            color: #fff;
            border: none;
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        .popup-confirm-btn:hover {
            background: #3182ce;
        }
        /* åª’ä½“æŸ¥è¯¢é€‚é…æ‰‹æœºç«¯ */
        @media (max-width: 30rem) {
            html {
                font-size: 14px !important;
            }
            .calculator-card {
                padding: 1.25rem 0.9375rem;
            }
            .history-btn {
                top: 1.25rem;
                right: 1.25rem;
                padding: 0.3125rem 0.625rem;
                font-size: 0.8125rem;
            }
            .card-title {
                font-size: 1.25rem;
                margin-bottom: 0.5rem;
            }
            .select-group {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.75rem;
            }
            .result-value {
                font-size: 1.375rem;
            }
            .popup-content {
                padding: 1.5625rem 1.25rem;
            }
        }
    </style>
</head>
<body>
    <!-- ä»‹ç»å¼¹çª— -->
    <div class="popup-modal" id="popupModal">
        <div class="popup-content">
            <div class="popup-text">
                å“ˆå–½ï½ æˆ‘æ˜¯å¸‚ç¬¬äºŒåä¸‰ä¸­å­¦23çº§çš„ä¸€åå­¦ç”Ÿï¼Œè¿™ä¸ªæ¹›æ±Ÿä¸­è€ƒæ€»åˆ†æŠ˜ç®—è®¡ç®—å™¨æ˜¯æˆ‘ç»“åˆAIè½¯ä»¶åˆ¶ä½œçš„ï¼<br><br>
                åˆè¡·æ˜¯æƒ³ç»™èº«è¾¹åŒå­¦æä¾›ä¸€ä¸ªæ–¹ä¾¿çš„åˆ†æ•°ä¼°ç®—å·¥å…·ï¼Œæ‰€æœ‰è®¡ç®—è§„åˆ™éƒ½å‚è€ƒäº†æ¹›æ±Ÿæ•™è‚²å±€å…¬å¼€æ ‡å‡†ï¼Œä½†éå®˜æ–¹å·¥å…·å¯èƒ½å­˜åœ¨å¾®å°è¯¯å·®ï¼Œä»…ä¾›å¤§å®¶å‚è€ƒå“¦ï½<br><br>
                å¦‚æœè§‰å¾—è¿™ä¸ªå·¥å…·å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¸å¦¨ç»™æˆ‘ä¸€ä¸ªå°å°çš„<span class="reward-link" onclick="window.open('https://yifan0207.github.io/dashang.png', '_blank')">æ‰“èµé¼“åŠ±</span>ä¸€ä¸‹å‘€ï¼ä½ çš„æ”¯æŒä¼šè®©æˆ‘æ›´æœ‰åŠ¨åŠ›ä¼˜åŒ–åŠŸèƒ½ã€åˆ†äº«æ›´å¤šå®ç”¨å·¥å…·ï½<br><br>
                æˆ‘çš„è”ç³»é‚®ç®±ï¼š2285626412@qq.comï¼Œæœ‰ä»»ä½•ä½¿ç”¨é—®é¢˜ã€ä¼˜åŒ–å»ºè®®ï¼Œéƒ½å¯ä»¥éšæ—¶å‘é‚®ä»¶å‘Šè¯‰æˆ‘å‘€ï¼ğŸ˜Š
            </div>
            <div class="popup-checkbox">
                <input type="checkbox" id="noShowToday">
                <label for="noShowToday">æš‚æ—¶ä¸æ˜¾ç¤º</label>
            </div>
            <button class="popup-confirm-btn" onclick="closePopupModal()">æˆ‘çŸ¥é“äº†</button>
        </div>
    </div>

    <div class="calculator-card">
        <button class="history-btn" onclick="openHistoryModal()">ğŸ”</button>
        <h2 class="card-title">æ¹›æ±Ÿä¸­è€ƒæ€»åˆ†æŠ˜ç®—è®¡ç®—å™¨</h2>
        <!-- 1. åŸºç¡€æ€§ç§‘ç›® -->
        <div class="form-group">
            <label class="form-label">1. åŸºç¡€æ€§ç§‘ç›®</label>
            <input type="number" id="chinese" class="form-input" placeholder="è¯­æ–‡æˆç»©ï¼ˆæ»¡åˆ†120ï¼‰" min="0" max="120">
            <input type="number" id="math" class="form-input" placeholder="æ•°å­¦æˆç»©ï¼ˆæ»¡åˆ†120ï¼‰" min="0" max="120">
            <input type="number" id="english" class="form-input" placeholder="è‹±è¯­æˆç»©ï¼ˆæ»¡åˆ†120ï¼‰" min="0" max="120">
            <input type="number" id="pe-score" class="form-input" placeholder="ä½“è‚²æˆç»©ï¼ˆæ»¡åˆ†80ï¼‰" min="0" max="80">
        </div>
        <!-- 2. ç§‘ç›®ç»„ -->
        <div class="form-group">
            <label class="form-label">2. ç§‘ç›®ç»„</label>
            <!-- ç‰©ç†+å†å²ç»„ -->
            <div class="sub-label">2.1 ç‰©ç†+å†å²ç»„</div>
            <input type="number" id="physics-written" class="form-input" placeholder="ç‰©ç†ç¬”è¯•æˆç»©ï¼ˆæ»¡åˆ†100åˆ†ï¼‰" min="0" max="100">
            <input type="number" id="physics-exam" class="form-input" placeholder="ç‰©ç†å®éªŒæ“ä½œæˆç»©ï¼ˆæ»¡åˆ†10åˆ†ï¼‰" min="0" max="10">
            <input type="number" id="history" class="form-input" placeholder="å†å²æˆç»©ï¼ˆæ»¡åˆ†100åˆ†ï¼‰" min="0" max="100">
            <div class="group-divider"></div>
            <!-- åŒ–å­¦+é“æ³•ç»„ -->
            <div class="sub-label">2.2 åŒ–å­¦+é“æ³•ç»„</div>
            <input type="number" id="chemistry-written" class="form-input" placeholder="åŒ–å­¦ç¬”è¯•æˆç»©ï¼ˆæ»¡åˆ†100åˆ†ï¼‰" min="0" max="100">
            <input type="number" id="chemistry-exam" class="form-input" placeholder="åŒ–å­¦å®éªŒæ“ä½œæˆç»©ï¼ˆæ»¡åˆ†10åˆ†ï¼‰" min="0" max="10">
            <input type="number" id="politics" class="form-input" placeholder="é“æ³•æˆç»©ï¼ˆæ»¡åˆ†100åˆ†ï¼‰" min="0" max="100">
            <div class="group-divider"></div>
            <!-- ç”Ÿç‰©+åœ°ç†ç»„ -->
            <div class="sub-label">2.3 ç”Ÿç‰©+åœ°ç†ç»„</div>
            <input type="number" id="biology-written" class="form-input" placeholder="ç”Ÿç‰©ç¬”è¯•æˆç»©ï¼ˆæ»¡åˆ†100åˆ†ï¼‰" min="0" max="100">
            <input type="number" id="biology-exam" class="form-input" placeholder="ç”Ÿç‰©å®éªŒæ“ä½œæˆç»©ï¼ˆæ»¡åˆ†10åˆ†ï¼‰" min="0" max="10">
            <input type="number" id="geography" class="form-input" placeholder="åœ°ç†æˆç»©ï¼ˆæ»¡åˆ†100åˆ†ï¼‰" min="0" max="100">
        </div>
        <!-- è®¡ç®—æŒ‰é’®ä¸ç»“æœ -->
        <button class="calc-btn" onclick="calculateTotal()">è®¡ç®—æŠ˜ç®—æ€»åˆ†</button>
        <div class="total-result">
            <div class="result-label">æŠ˜ç®—åæ€»åˆ†</div>
            <div class="result-value" id="totalScore">--</div>
            <div class="result-comment" id="scoreComment"></div>
        </div>
        <!-- å¾—åˆ†è¯¦æƒ… -->
        <div class="detail-group">
            <h3 class="detail-title">å„é¡¹ç›®å¾—åˆ†è¯¦æƒ…</h3>
            <div class="detail-item">
                <span class="detail-label">è¯­æ–‡ï¼š</span>
                <span class="detail-value" id="detailChinese">--</span>
            </div>
            <div class="detail-item">
                <span class="detail-label">æ•°å­¦ï¼š</span>
                <span class="detail-value" id="detailMath">--</span>
            </div>
            <div class="detail-item">
                <span class="detail-label">è‹±è¯­ï¼š</span>
                <span class="detail-value" id="detailEnglish">--</span>
            </div>
            <div class="detail-item">
                <span class="detail-label">ä½“è‚²ï¼š</span>
                <span class="detail-value" id="detailPe">--</span>
            </div>
            <div class="detail-item">
                <span class="detail-label">ç‰©ç†+å†å²ç»„ï¼š</span>
                <span class="detail-value" id="detailPhHis">--</span>
            </div>
            <div class="detail-item">
                <span class="detail-label">åŒ–å­¦+é“æ³•ç»„ï¼š</span>
                <span class="detail-value" id="detailChPo">--</span>
            </div>
            <div class="detail-item">
                <span class="detail-label">ç”Ÿç‰©+åœ°ç†ç»„ï¼š</span>
                <span class="detail-value" id="detailBiGe">--</span>
            </div>
            <div class="non-official-tip">ï¼ˆéå®˜æ–¹å·¥å…·ï¼Œå¯èƒ½å­˜åœ¨å°è¯¯å·®ï¼‰</div>
        </div>
        <!-- æ¸©é¦¨æç¤º -->
        <div class="tip-group">
            <div class="tip-title">æ¸©é¦¨æç¤º</div>
            <div class="tip-content">
                1. è®¡ç®—æ ‡å‡†è¯´æ˜ï¼šæœ¬å·¥å…·çš„è®¡ç®—æ ‡å‡†ä¾é çš„æ˜¯æ¹›æ±Ÿæ•™è‚²å±€å…¬å¼€å¯æŸ¥è¯¢åˆ°çš„æ ‡å‡†ï¼Œæˆªæ­¢åˆ°2025å¹´11æœˆä»æœ‰æ•ˆï¼›<br>
                2. ç§‘ç›®ç»„è§„åˆ™ï¼šè‹¥åŒä¸€ç§‘ç›®ç»„å†…æœ‰ä¸€ç§‘æœªè€ƒï¼ˆç•™ç©ºï¼‰ï¼Œå¦ä¸€ç§‘è‡ªåŠ¨æŒ‰é«˜åˆ†ç§‘ç›®è®¡ç®—ï¼›<br>
                3. å®éªŒåˆ†è§„åˆ™ï¼šè‹¥å®éªŒæ“ä½œæˆç»©ç•™ç©ºï¼Œé»˜è®¤ä¸è®¡ç®—å®éªŒåˆ†ï¼Œä»…æŒ‰ç¬”è¯•æˆç»©100%è®¡å…¥æ€»åˆ†ï¼›<br>
                4. å°æ•°å¤„ç†è§„åˆ™ï¼ˆç²¾ç¡®é€‚é…è®¡ç®—é€»è¾‘ï¼‰ï¼š<br>
                   â€¢ è®¡ç®—ç»“æœçš„å°æ•°éƒ¨åˆ†ï¼œ0.25æ—¶ï¼Œç›´æ¥èˆå»å°æ•°ï¼Œä¿ç•™æ•´æ•°ï¼›<br>
                   â€¢ è®¡ç®—ç»“æœçš„å°æ•°éƒ¨åˆ†åœ¨0.25ï¼ˆå«ï¼‰-0.75ï¼ˆä¸å«ï¼‰ä¹‹é—´æ—¶ï¼Œä¿ç•™ä¸€ä½å°æ•°0.5ï¼›<br>
                   â€¢ è®¡ç®—ç»“æœçš„å°æ•°éƒ¨åˆ†â‰¥0.75æ—¶ï¼Œå°æ•°éƒ¨åˆ†è¿›1ï¼Œä¿ç•™æ•´æ•°ï¼›<br>
                   ä¾‹ï¼š3.2â†’3ï¼Œ4.5â†’4.5ï¼Œ5.8â†’6
            </div>
        </div>
    </div>
    <!-- å†å²è®°å½•å¼¹çª— -->
    <div class="history-modal" id="historyModal">
        <div class="history-content">
            <button class="close-modal" onclick="closeHistoryModal()">&times;</button>
            <h3 class="history-title">è®¡ç®—å†å²è®°å½•</h3>
            <div id="historyList" class="history-list">
                <div class="history-empty">æš‚æ— è®¡ç®—è®°å½•</div>
            </div>
        </div>
    </div>
    <script>
// ä»æœ¬åœ°å­˜å‚¨åŠ è½½å†å²è®°å½•ï¼ˆé¡µé¢åˆå§‹åŒ–æ—¶æ‰§è¡Œï¼‰
let calculateHistory = JSON.parse(localStorage.getItem('zhongkaoCalcHistory')) || [];
// è¾“å…¥æ¡†é¡ºåºåˆ—è¡¨ï¼šæŒ‰é¡µé¢æ˜¾ç¤ºé¡ºåºæ’åˆ—ï¼Œç”¨äºå›è½¦åˆ‡æ¢
const inputOrder = [
    'chinese', 'math', 'english', 'pe-score',
    'physics-written', 'physics-exam', 'history',
    'chemistry-written', 'chemistry-exam', 'politics',
    'biology-written', 'biology-exam', 'geography'
];
// ç»†åˆ†åˆ†æ•°æ®µè¯„è¯­
const scoreComments = [
    { min: 740, comment: 'è¶…é¡¶å°–æ€»åˆ†ï¼å®åŠ›ç¢¾å‹åŒçº§ï¼Œä¿æŒç¨³å®šå‘æŒ¥ï¼Œå†²åˆºå…¨å¸‚ä¼˜è´¨é«˜ä¸­å¤´éƒ¨æ¢¯é˜Ÿï¼' },
    { min: 710, max: 739, comment: 'é¡¶å°–æ°´å¹³ï¼æ€»åˆ†ç«äº‰åŠ›æå¼ºï¼Œç»†èŠ‚å¤„å°‘ä¸¢åˆ†ï¼Œå³å¯å‘æ›´é«˜åæ¬¡å†²å‡»ï¼' },
    { min: 700, max: 709, comment: 'æ€»åˆ†é¡¶å°–ï¼å®åŠ›è¶…ç¾¤ï¼Œä¿æŒçŠ¶æ€å†²åˆºç†æƒ³é«˜ä¸­ï¼' },
    { min: 670, max: 699, comment: 'é«˜åˆ†ç¨³æ‹¿ï¼æ€»åˆ†ä¼˜åŠ¿æ˜æ˜¾ï¼Œä¿æŒç°æœ‰èŠ‚å¥ï¼Œå†²åˆºé‡ç‚¹é«˜ä¸­æ— å¿§ï¼' },
    { min: 640, max: 669, comment: 'æˆç»©ä¼˜ç§€ï¼å°å¹…ä¼˜åŒ–ç»†èŠ‚ï¼Œå³å¯å‘é¡¶å°–è¿ˆè¿›ï¼' },
    { min: 610, max: 639, comment: 'ä¼˜ç§€æ°´å‡†ï¼æ€»åˆ†åŸºç¡€æ‰å®ï¼Œä¼˜åŒ–ç­”é¢˜æ•ˆç‡ï¼Œåˆ†æ•°ä»æœ‰ä¸Šå‡ç©ºé—´ï¼' },
    { min: 580, max: 609, comment: 'åŸºç¡€æ‰å®ï¼é’ˆå¯¹æ€§æå‡ï¼Œæ€»åˆ†æœ‰æœ›å¤§å¹…çªç ´ï¼' },
    { min: 550, max: 579, comment: 'ç¨³æ­¥å‰è¡Œï¼æ€»åˆ†å¤„äºä¸­ä¸Šæ°´å¹³ï¼Œå·©å›ºåŸºç¡€é¢˜ï¼Œé¿å…å¤±è¯¯å°±èƒ½æåˆ†ï¼' },
    { min: 520, max: 549, comment: 'è¾¾åˆ°åˆæ ¼çº¿ï¼å·©å›ºä¸»ç§‘åŸºç¡€ï¼Œç¨³æ­¥æå‡æ›´é«˜æ•ˆï¼' },
    { min: 480, max: 519, comment: 'æ¥è¿‘åˆæ ¼çº¿ï¼èšç„¦åŸºç¡€é¢˜å‹ï¼Œä¿è¯ä¼šåšçš„é¢˜ä¸ä¸¢åˆ†ï¼Œæåˆ†è§æ•ˆå¿«ï¼' },
    { min: 430, max: 479, comment: 'åŸºç¡€å¾…å¼ºåŒ–ï¼ä»é«˜é¢‘åŸºç¡€è€ƒç‚¹å…¥æ‰‹ï¼Œé€æ­¥ç§¯ç´¯ï¼Œæ€»åˆ†ç¨³æ­¥ä¸Šæ¶¨ï¼' },
    { min: 380, max: 429, comment: 'æ½œåŠ›å¾…æŒ–æ˜ï¼ä¼˜å…ˆæŒæ¡ç®€å•é¢˜å’Œä¸­æ¡£é¢˜ï¼Œå‡å°‘å¤±åˆ†ï¼Œè¿›æ­¥çœ‹å¾—è§ï¼' },
    { min: 330, max: 379, comment: 'èµ·æ­¥é˜¶æ®µåŠ æ²¹ï¼é‡ç‚¹æ”»å…‹åŸºç¡€å¾—åˆ†ç‚¹ï¼Œæ…¢æ…¢ç§¯ç´¯ï¼Œæ€»åˆ†ä¼šæœ‰å¤§çªç ´ï¼' },
    { max: 329, comment: 'æ½œåŠ›åè¶³ï¼å…ˆæŠ“åŸºç¡€å¾—åˆ†ï¼Œè¿›æ­¥ä¼šå¾ˆæ˜æ˜¾ï¼' }
];

// å¼¹çª—æ§åˆ¶ç›¸å…³é€»è¾‘
document.addEventListener('DOMContentLoaded', () => {
    const noShowToday = localStorage.getItem('popupNoShowToday');
    const popupModal = document.getElementById('popupModal');
    if (!noShowToday || new Date().getTime() > parseInt(noShowToday)) {
        popupModal.style.display = 'flex';
    } else {
        popupModal.style.display = 'none';
    }
});

// å…³é—­é¦–æ¬¡å¼¹çª—
function closePopupModal() {
    const popupModal = document.getElementById('popupModal');
    const noShowToday = document.getElementById('noShowToday').checked;
    if (noShowToday) {
        const expiresTime = new Date().getTime() + 1 * 60 * 60 * 1000;
        localStorage.setItem('popupNoShowToday', expiresTime.toString());
    }
    popupModal.style.display = 'none';
}

// 1. æ ¸å¿ƒè®¡ç®—å‡½æ•°
function calculateTotal() {
    // å·¥å…·å‡½æ•°1ï¼šå¤„ç†è¾“å…¥åˆ†æ•°ï¼ˆç•™ç©º/éæ•°å­—é»˜è®¤ä¸º0ï¼Œé™åˆ¶æ»¡åˆ†èŒƒå›´ï¼‰
    const getScore = (id, max = 100) => {
        const inputVal = document.getElementById(id)?.value.trim() || '';
        const numVal = inputVal ? parseFloat(inputVal) : 0;
        return Math.max(0, Math.min(isNaN(numVal) ? 0 : numVal, max));
    };
    // å·¥å…·å‡½æ•°2ï¼šè®¡ç®—ç†ç§‘æœ€ç»ˆæˆç»©ï¼ˆé»˜è®¤å®éªŒ10åˆ†åˆ¶ï¼‰
    const calculateSciFinalScore = (writtenId, examId) => {
        const writtenScore = getScore(writtenId);
        const examScore = getScore(examId, 10);
        return examScore === 0 ? writtenScore : writtenScore * 0.9 + examScore;
    };
    // å·¥å…·å‡½æ•°3ï¼šæ•´æ•°è¿ç®—è§„é¿æµ®ç‚¹æ•°è¯¯å·®
    const safeMultiply = (score, multiple, divisor) => (score * multiple) / divisor;
    // å·¥å…·å‡½æ•°4ï¼šå°æ•°å¤„ç†ï¼ˆæŒ‰æ˜ç¡®è§„åˆ™å®ç°ï¼‰
    const handleDecimal = (num) => {
        const decimalPart = num - Math.floor(num);
        if (decimalPart < 0.25) {
            return Math.floor(num);
        } else if (decimalPart < 0.75) {
            return Math.floor(num) + 0.5;
        } else {
            return Math.ceil(num);
        }
    };
    // è®¡ç®—åŸºç¡€æ€§ç§‘ç›®å¾—åˆ†
    const chineseFin = handleDecimal(getScore('chinese', 120));
    const mathFin = handleDecimal(getScore('math', 120));
    const englishFin = handleDecimal(safeMultiply(getScore('english', 120), 100, 120));
    const peFin = handleDecimal(getScore('pe-score', 80));
    // è®¡ç®—ç§‘ç›®ç»„å¾—åˆ†ï¼ˆè°ƒç”¨è¾…åŠ©å‡½æ•°ï¼‰
    const physicsFinal = calculateSciFinalScore('physics-written', 'physics-exam');
    const historyFinal = getScore('history');
    const phHisTotal = handleDecimal(getGroupTotal(physicsFinal, historyFinal, 8, 10, 'firstType'));
    const chemistryFinal = calculateSciFinalScore('chemistry-written', 'chemistry-exam');
    const politicsFinal = getScore('politics');
    const chPoTotal = handleDecimal(getGroupTotal(chemistryFinal, politicsFinal, 7, 10, 'firstType'));
    const biologyFinal = calculateSciFinalScore('biology-written', 'biology-exam');
    const geographyFinal = getScore('geography');
    const biGeTotal = handleDecimal(getGroupTotal(biologyFinal, geographyFinal, 1, 2, 'secondType'));
    // è®¡ç®—æ€»åˆ†
    const totalScore = handleDecimal(chineseFin + mathFin + englishFin + peFin + phHisTotal + chPoTotal + biGeTotal);
    // æ›´æ–°é¡µé¢æ˜¾ç¤º
    document.getElementById('totalScore').textContent = totalScore;
    let comment = '';
    for (let item of scoreComments) {
        if ((!item.min || totalScore >= item.min) && (!item.max || totalScore <= item.max)) {
            comment = item.comment;
            break;
        }
    }
    document.getElementById('scoreComment').textContent = comment;
    // æ›´æ–°è¯¦æƒ…
    document.getElementById('detailChinese').textContent = chineseFin;
    document.getElementById('detailMath').textContent = mathFin;
    document.getElementById('detailEnglish').textContent = englishFin;
    document.getElementById('detailPe').textContent = peFin;
    document.getElementById('detailPhHis').textContent = phHisTotal;
    document.getElementById('detailChPo').textContent = chPoTotal;
    document.getElementById('detailBiGe').textContent = biGeTotal;
    // è®°å½•æœ¬æ¬¡è®¡ç®—ï¼ˆå«æ—¶é—´ã€æ€»åˆ†ã€è¯¦æƒ…ï¼‰
    recordCalculation({
        time: getFormattedTime(),
        total: totalScore,
        comment: comment,
        details: {
            chinese: chineseFin,
            math: mathFin,
            english: englishFin,
            pe: peFin,
            phHis: phHisTotal,
            chPo: chPoTotal,
            biGe: biGeTotal
        }
    });
}
// 2. ç§‘ç›®ç»„å¾—åˆ†è®¡ç®—è¾…åŠ©å‡½æ•°
function getGroupTotal(score1, score2, highMultiple, highDivisor, type) {
    const [highScore, lowScore] = score1 === 0 
        ? [score2, 0] 
        : (score2 === 0 ? [score1, 0] : (score1 >= score2 ? [score1, score2] : [score2, score1]));
    const highConverted = (highScore * highMultiple) / highDivisor;
    let lowConverted = 0;
    if (lowScore > 0) {
        if (lowScore >= 80) {
            lowConverted = type === 'firstType' ? 50 : 40;
        } else if (lowScore >= 15) {
            lowConverted = type === 'firstType' ? (lowScore * 5) / 8 : (lowScore * 1) / 2;
        }
    }
    return highConverted + lowConverted;
}
// 3. å†å²è®°å½•ç›¸å…³å‡½æ•°
// 3.1 è·å–æ ¼å¼åŒ–æ—¶é—´ï¼ˆç²¾ç¡®åˆ°ç§’ï¼šå¹´-æœˆ-æ—¥ æ—¶:åˆ†:ç§’ï¼‰
function getFormattedTime() {
    const now = new Date();
    const year = now.getFullYear();
    const month = String(now.getMonth() + 1).padStart(2, '0');
    const day = String(now.getDate()).padStart(2, '0');
    const hour = String(now.getHours()).padStart(2, '0');
    const minute = String(now.getMinutes()).padStart(2, '0');
    const second = String(now.getSeconds()).padStart(2, '0');
    return `${year}-${month}-${day} ${hour}:${minute}:${second}`;
}
// 3.2 è®°å½•æœ¬æ¬¡è®¡ç®—ï¼ˆå­˜å…¥æœ¬åœ°å­˜å‚¨+æ›´æ–°å†å²åˆ—è¡¨ï¼‰
function recordCalculation(record) {
    calculateHistory.unshift(record);
    if (calculateHistory.length > 9999) calculateHistory.pop();
    localStorage.setItem('zhongkaoCalcHistory', JSON.stringify(calculateHistory));
    renderHistoryList();
}
// 3.3 æ¸²æŸ“å†å²è®°å½•åˆ—è¡¨
function renderHistoryList() {
    const historyListEl = document.getElementById('historyList');
    if (calculateHistory.length === 0) {
        historyListEl.innerHTML = '<div class="history-empty">æš‚æ— è®¡ç®—è®°å½•</div>';
        return;
    }
    let historyHtml = '';
    calculateHistory.forEach((item, index) => {
        const recordNum = calculateHistory.length - index;
        historyHtml += `
            <div class="history-item">
                <div class="history-time">${item.time}ï¼ˆç¬¬${recordNum}æ¬¡è®¡ç®—ï¼‰</div>
                <div class="history-total">æŠ˜ç®—æ€»åˆ†ï¼š${item.total} | ${item.comment}</div>
                <div class="history-detail">å„ç§‘ç›®è¯¦æƒ…ï¼š</div>
                <div class="history-detail-item">
                    <span>è¯­æ–‡</span>
                    <span>${item.details.chinese}</span>
                </div>
                <div class="history-detail-item">
                    <span>æ•°å­¦</span>
                    <span>${item.details.math}</span>
                </div>
                <div class="history-detail-item">
                    <span>è‹±è¯­</span>
                    <span>${item.details.english}</span>
                </div>
                <div class="history-detail-item">
                    <span>ä½“è‚²</span>
                    <span>${item.details.pe}</span>
                </div>
                <div class="history-detail-item">
                    <span>ç‰©ç†+å†å²ç»„</span>
                    <span>${item.details.phHis}</span>
                </div>
                <div class="history-detail-item">
                    <span>åŒ–å­¦+é“æ³•ç»„</span>
                    <span>${item.details.chPo}</span>
                </div>
                <div class="history-detail-item">
                    <span>ç”Ÿç‰©+åœ°ç†ç»„</span>
                    <span>${item.details.biGe}</span>
                </div>
            </div>
        `;
    });
    historyListEl.innerHTML = historyHtml;
}
// 3.4 æ‰“å¼€å†å²è®°å½•å¼¹çª—
function openHistoryModal() {
    renderHistoryList();
    document.getElementById('historyModal').style.display = 'flex';
}
// 3.5 å…³é—­å†å²è®°å½•å¼¹çª—
function closeHistoryModal() {
    document.getElementById('historyModal').style.display = 'none';
}
// 4. é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–ï¼ˆå›è½¦åˆ‡æ¢è¾“å…¥æ¡†ï¼‰
document.addEventListener('DOMContentLoaded', () => {
    inputOrder.forEach((inputId, index) => {
        const input = document.getElementById(inputId);
        if (input) {
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    if (index < inputOrder.length - 1) {
                        const nextInput = document.getElementById(inputOrder[index + 1]);
                        if (nextInput) nextInput.focus();
                    } else {
                        input.blur();
                        calculateTotal();
                    }
                }
            });
        }
    });
});
    </script>
</body>
</html>
